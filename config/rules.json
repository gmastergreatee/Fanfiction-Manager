[
    {
        "guid": "bf04cf84-1bfc-4233-9fa7-19871eaca783",
        "rule_name": "Fanfiction.net",
        "url_regex": "(?:https://)*(?:www|m).fanfiction.net/([a-z]+)/([0-9]+)/([0-9]+)/([a-zA-Z0-9-]+)",
        "pagetype_code": "if (document.querySelector('#cf-wrapper #cookie-alert'))\n    return -2;\nif (document.querySelector('.cf-browser-verification.cf-im-under-attack'))\n    return -1;\nif (document.querySelector('#chap_select'))\n    return 0;",
        "toc_code": "let retMe = {\n  'CoverURL': '',\n  'Title': 'novel name here',\n  'Summary': '',\n  'ChapterCount': 1,\n  'ChapterURLs': [],\n};\n\nlet chaps = [];\nArray.from($('#chap_select').first().find('option')).forEach(el=>{\n    chaps.push(el.value);\n});\n\nlet matches = new RegExp('(?:https://)*(?:www|m).fanfiction.net/([a-z]+)/([0-9]+)/([0-9]+)/([a-zA-Z0-9-]+)').exec(window.location.href);\nchaps.forEach(el => {\n    retMe.ChapterURLs.push([window.location.origin, matches[1], matches[2], el, matches[4]].join('/'));\n});\n\nretMe.ChapterCount = chaps.length;\nretMe.Title = $('#profile_top b').html();\nretMe.Summary = $('#profile_top div.xcontrast_txt').html();\nlet cover_url = $('#profile_top .cimage')[0].src;\nif (cover_url) {\n    retMe.CoverURL = cover_url.substr(0, cover_url.length - 3) + '180/';\n}\n\nreturn retMe;",
        "chapter_code": "let retMe = [\n  {\n    \"title\": \"\",    // title of chapter\n    \"content\": $('.storytext').html(),  // content\n    \"nextURL\": \"\"\n  },\n];\n\nlet chap_select = document.getElementById('chap_select');\nif (chap_select != null) {\n    retMe[0].title = chap_select.options[chap_select.selectedIndex].text;\n}\n\nreturn retMe;"
    }
]