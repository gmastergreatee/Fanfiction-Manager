[
  {
    "guid": "5516b773-f939-4c68-89c1-4c8ba6641822",
    "rule_name": "Royalroad.com",
    "url_regex": "(?:https://)*(?:www|m).royalroad.com/fiction/.+",
    "pagetype_code": "// https://www.royalroad.com/fiction/53329/reborn-in-naruto-with-my-girlfriend/chapter/884590/1--reincarnation-and-wishes-prologue\n// https://www.royalroad.com/fiction/53329/reborn-in-naruto-with-my-girlfriend\n\nif (document.querySelector('.fic-header h1') != null) {\n    return 0;\n}",
    "toc_code": "let retMe = {\n  'CoverURL': window.fictionCover,\n  'Title': document.querySelector('.fic-header h1').innerText,\n  'Summary': document.querySelector('.fiction-info .description div').innerHTML.trim().replace(/\\n/g, ''),\n  'ChapterCount': window.chapters.length,\n  'ChapterURLs': window.chapters.map(i => window.location.origin + i.url),\n};\n\nreturn retMe;",
    "chapter_code": "let retMe = [\n  {\n    \"title\": document.querySelector('.fic-header h1').innerText,    // title of chapter\n    \"content\": document.querySelector('.chapter-content').innerHTML.trim().replace(/\\n/g,'').replace(/ data-original-margin=\"\"/g, ''),\n    \"nextURL\": \"\"   // when \"ChapterCount\" <= 0 & \"nextURL\" always comes non-empty\n                    // will loop infinitely unless something else(javascript) breaks\n  },\n];\n\nreturn retMe;",
    "url_blocks": "/a/c?\nanalytics.google\nsentry.js\nsite.js\n.woff2\n/covers\n/gtag\n/img/\ngstatic.com\n.png\nwebfont\nelastic-rum\nsecurepubads\namazon\n/ads\n.css\nemail-decode\nfonts.googleapis"
  },
  {
    "guid": "1456f9af-ab7e-4f5f-b441-77a30ede82b5",
    "rule_name": "COMRADEMAO",
    "url_regex": "(?:https://)*(?:www|m)*.comrademao.com/novel/.*",
    "pagetype_code": "if (jQuery || $) {\n$ = jQuery\n\nif ($('.entry-title').length > 0)\n    return 0;\n\nif ($('#chaptercontent').length > 0)\n    return 0;\n}",
    "toc_code": "let retMe = {\n  'CoverURL': $('.seriedetailcontent img')[0].src,\n  'Title': $('.infox h1')[0].innerText,\n  'Summary': $('.infox div:last').find('p')[0].innerHTML.replace(/\\n/g,''),\n  'ChapterCount': 1,           // chapter count here\n  'ChapterURLs': Array.from($('#chapterlist li a')).map(i => i.href).reverse(),\n};\n\nretMe.ChapterCount = retMe.ChapterURLs.length;\n\nreturn retMe;",
    "chapter_code": "if (jQuery || $) {\n    $ = jQuery\n}\n\n$('script,style,iframe').remove();\n\nlet retMe = [\n  {\n    \"title\": $('#chaptercontent .doc_header')[0].innerText,    // title of chapter\n    \"content\": $('#chaptercontent div')[0].innerHTML,  // content\n    \"nextURL\": \"\"   // when \"ChapterCount\" <= 0 & \"nextURL\" always comes non-empty\n                    // will loop infinitely unless something else(javascript) breaks\n  },\n];\n\nreturn retMe;",
    "url_blocks": "script.js\nuniconsent\npolls-js\nwpdcc\nwpdiscuz\nquicktags\ncomment-reply\nwp-emoji\ntranslate.google\n/collect?\n.css\n/gtag/\n/img/"
  },
  {
    "guid": "16ea8bfb-ab60-4043-a8e8-71a6928d3cd3",
    "rule_name": "NovelUpdates.com",
    "url_regex": "(?:https://)*(?:www|m).novelupdates.com/series/.+",
    "pagetype_code": "if ($('.my_popupreading_open').length >= 1)\n    return 0;",
    "toc_code": "let retMe = {\n  'CoverURL': '',              // may be empty\n  'Title': 'novel name here',\n  'Summary': '',               // may be empty\n  'ChapterCount': 1,           // chapter count here\n  'ChapterURLs': [             // list of chapter-URLs\n      '',                      // must contain atleast the first chapter URL\n      '',\n  ],\n};\n\nvar secs = 0;\n$('.my_popupreading_open').click();\n\nwhile ($('#my_popupreading a').length <= 0) {\n    await sleep(1000);\n    secs = 1;\n    if (secs >= 10)\n        return null;\n}\n\nretMe.CoverURL = $('.seriesimg img')[0].src;\nretMe.Title = $('.w-blog-content div')[0].innerText;\nretMe.Summary = $('#editdescription').html().replace(/\\n/g,'');\nretMe.ChapterURLs = Array.from($('#my_popupreading a[data-id]')).map(el => el.href).reverse();\nretMe.ChapterCount = retMe.ChapterURLs.length;\n\nreturn retMe;",
    "chapter_code": "let retMe = [\n  {\n    \"title\": \"\",    // title of chapter\n    \"content\": \"\",  // content\n    \"nextURL\": \"\"   // when \"ChapterCount\" <= 0 & \"nextURL\" always comes non-empty\n                    // will loop infinitely unless something else(javascript) breaks\n  },\n];\n\n//return retMe;\n\n// as novelupdates redirects to externel websites therefore chapter-script won't be run here\nreturn null;",
    "url_blocks": ""
  },
  {
    "guid": "bf04cf84-1bfc-4233-9fa7-19871eaca783",
    "rule_name": "Fanfiction.net",
    "url_regex": "(?:https://)*(?:www|m).fanfiction.net/([a-z]+)/([0-9]+)/([0-9]+)/([a-zA-Z0-9-]+)",
    "pagetype_code": "if (document.querySelector('#cf-wrapper #cookie-alert'))\n    return -1;\nif (document.querySelector('.cf-browser-verification.cf-im-under-attack'))\n    return -2;\nif (document.querySelector('#chap_select'))\n    return 0;",
    "toc_code": "let retMe = {\n  'CoverURL': '',\n  'Title': 'novel name here',\n  'Summary': '',\n  'ChapterCount': 1,\n  'ChapterURLs': [],\n};\n\nlet chaps = [];\nArray.from($('#chap_select').first().find('option')).forEach(el=>{\n    chaps.push(el.value);\n});\n\nlet matches = new RegExp('(?:https://)*(?:www|m).fanfiction.net/([a-z]+)/([0-9]+)/([0-9]+)/([a-zA-Z0-9-]+)').exec(window.location.href);\nchaps.forEach(el => {\n    retMe.ChapterURLs.push([window.location.origin, matches[1], matches[2], el, matches[4]].join('/'));\n});\n\nretMe.ChapterCount = chaps.length;\nretMe.Title = $('#profile_top b')[0].innerText;\nretMe.Summary = $('#profile_top div.xcontrast_txt').html();\nlet cover_url = $('#profile_top .cimage')[0].src;\nif (cover_url) {\n    retMe.CoverURL = cover_url.substr(0, cover_url.length - 3) + '180/';\n}\n\nreturn retMe;",
    "chapter_code": "let retMe = [\n  {\n    \"title\": \"\",    // title of chapter\n    \"content\": $('.storytext').html(),  // content\n    \"nextURL\": \"\"\n  },\n];\n\nlet chap_select = document.getElementById('chap_select');\nif (chap_select != null) {\n    retMe[0].title = chap_select.options[chap_select.selectedIndex].text;\n}\n\nreturn retMe;",
    "url_blocks": "adsbygoogle\n.css\n/image/"
  },
  {
    "guid": "4795a493-2a6e-4234-8dec-307b06129cd6",
    "rule_name": "WebNovel.com",
    "url_regex": "(?:https://)*(?:www|m)\\.webnovel\\.com/([a-z]+)/([0-9a-z\\-A-Z]+)_([0-9]+)",
    "pagetype_code": "// chapter page 2 - actually checking JSON API\ntry {\n    let jsonObj = JSON.parse(document.body.innerText);\n    if (jsonObj.data.chapterInfo.chapterName)\n        return 0;\n} catch { }\n\n// toc page\nlet toc = $('a[title=\"Table of Contents\"]');\nif (toc && toc.length == 1) {\n    return 0;\n}\n\n// chapter page 1\nlet chapter = $('.cha-tit');\nif (chapter && chapter.length == 1) {\n    return 0;\n}",
    "toc_code": "// throw error if TOCScript script run on chapter page\nlet chapter = $('.cha-tit');\nif (chapter && chapter.length == 1) {\n    return null;\n}\n\nlet retMe = {\n  'CoverURL': $('.det-info img')[1].src,\n  'Title': $('.det-info h1')[0].innerText.trim(),\n  'Summary': $('.det-tab-pane p')[0].innerHTML.trim(),\n  'ChapterCount': parseInt($('.det-hd h2 strong span')[0].innerText),\n  'ChapterURLs': [],\n};\n\nlet waitSeconds = 0;\n$('a[title=\"Table of Contents\"]')[0].click();\n\nwhile ($('#contents .g_loading').length)\n{\n    await sleep(1000);\n    waitSeconds += 1;\n    if (waitSeconds >= 10)\n        return null;\n}\n\nretMe.ChapterURLs = Array.from($('#contents a')).slice(1).map(el => el.href);\n\nreturn retMe;",
    "chapter_code": "let retMe = [\n  {\n    \"title\": \"\",    // title of chapter\n    \"content\": \"\",  // content\n    \"nextURL\": \"\"   // when \"ChapterCount\" <= 0 & \"nextURL\" always comes non-empty\n                    // will loop infinitely unless something else(javascript) breaks\n  },\n];\n\n// checking if REST API used\ntry {\n    let jsonObj = JSON.parse(document.body.innerText);\n    retMe[0].content = '<p>' + jsonObj.data.chapterInfo.contents.map(i=>i.content.replace('\\r\\n', '')).join('</p><p>') + '</p>';\n    retMe[0].title = jsonObj.data.chapterInfo.chapterName;\n    retMe[0].nextURL = window.location.href.split('&').map((el,i)=> i == 3 ? 'chapterId=' + jsonObj.data.chapterInfo.nextChapterId : el).join('&');\n    return retMe;\n} catch { }\n\n// getting data from random page\nretMe[0].title = new RegExp(/(?:^.*):\\s(.*)/).exec($('#page .cha-tit h1').html())[1];\nretMe[0].content = \"<p>\" + Array.from($(\".cha-words p\")).map((i) => i.innerHTML.trim()).join(\"</p><p>\") + \"</p>\";\n\nlet matches = new RegExp(/.*\\/(\\d+)\\/(\\d+)/).exec($('link[rel=next]')[0].href);\nlet bookId = matches[1];\nlet nextChapterId = matches[2];\nlet _csrfToken = (await cookieStore.get('_csrfToken')).value;\nlet _fsae = (await cookieStore.get('_fsae')).value;\n\nretMe[0].nextURL = 'https://www.webnovel.com/go/pcm/chapter/getContent?' +\n    '_csrfToken=' + _csrfToken +\n    '&_fsae=' + _fsae +\n    '&bookId=' + bookId +\n    '&chapterId=' + nextChapterId +\n    '&encryptType=3&_=' + _fsae;\n\nreturn retMe;",
    "url_blocks": ".css\nquora\ngoogle\n/emoji\n/recommend\n/bookReview\n/powerStone\n/checkStatus"
  }
]